---
title: "Running PGS on MIS"
format: html
---

## Setup

Several imputation servers are available, each hosting different reference panels. In this tutorial, we will use the main instance of the **Michigan Imputation Server**. Before starting, make sure you complete the following prerequisites:

1. Create an account.  
2. Download the required [array data](https://genepi.i-med.ac.at/downloads/imputation/gwas.array.hapmap.chr20.vcf.gz) for PGS calculation.  

## Prepare Your Data

The dataset used in this tutorial has already been prepared for the Michigan Imputation Server. For your own data, please follow our [Data Preparation Guide](http://genepi.github.io/michigan-imputationserver/prepare-your-data/).  

In general, the following requirements must be met:  

- Create a separate `.vcf.gz` file for each chromosome.  
- Ensure that variants are sorted by genomic position.  
- Use either **GRCh37** or **GRCh38** coordinates.  

## Login

After a successful login, you can start a new job using the **Run** tab or check previously submitted jobs under the **Jobs** tab.  

![](images/imputation/start.png)  

## Polygenic Score Calculation

The Michigan Imputation Server offers several applications, including Genotype Imputation, HLA Imputation, and Polygenic Score Calculation. In this tutorial, we focus on **Polygenic Score Calculation**.

![](images/imputation/select-app.png)  

::: {.callout-note}
Please note that this app does not return imputed datasets to users. 
:::


## Start Calculation

After selecting the app, fill in the following fields and click **Start Calculation**:  

- **Name:** Any name of your choice  
- **Reference Panel:** HapMap 2  
- **Input Files:** `gwas.array.hapmap.chr20.vcf.gz`  
- **Scores:** Tutorial (Simulated Scores)  
- **Ancestry Estimation:** Worldwide

![](images/pgs/select-app-with-data.png)  

## Job Queue

Once submitted, your job will go through **Input Validation**, **Quality Control (QC)**, **Phasing/Imputation**, and **Polygenic Risk Calculation**. Jobs are queued, and you will receive a notification when your PGS calculation is complete.  

## Input Validation and QC

The screenshots below illustrate statistics from input validation and quality control:  

![](images/pgs/input-validation.png)  
![](images/pgs/qc.png)  

## Running Jobs

The job is now queued and typically runs for around 30 minutes, depending on queue availability.  

![](images/pgs/running-job.png)  

## Download Results

Once your job is complete, you will receive a notification. You can then download your results in one of the following ways:

1. Click on one of the files to download the file directly.  
2. Or use the `wget` command in your terminal.


![](images/pgs/results.png)

---

## Next Steps

The available scores file (`scores.txt`) can be used to run the PGS analysis as described [here](/pgs.html).